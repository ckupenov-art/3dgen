<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Simple 3D Cube Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #050816;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      color: #f9fafb;
    }

    #app {
      position: fixed;
      inset: 0;
      display: flex;
      flex-direction: column;
    }

    header {
      padding: 0.75rem 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(15, 23, 42, 0.85);
      backdrop-filter: blur(12px);
      z-index: 10;
      border-bottom: 1px solid rgba(148, 163, 184, 0.3);
    }

    header h1 {
      margin: 0;
      font-size: 1rem;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: #e5e7eb;
    }

    header span {
      font-size: 0.75rem;
      color: #9ca3af;
    }

    #controls {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 0.4rem 0.9rem;
      cursor: pointer;
      font-size: 0.8rem;
      font-weight: 500;
      background: #4f46e5;
      color: white;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      box-shadow: 0 8px 20px rgba(79, 70, 229, 0.4);
      transition: transform 0.12s ease, box-shadow 0.12s ease,
        background 0.12s ease;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 12px 24px rgba(79, 70, 229, 0.55);
      background: #4338ca;
    }

    button:active {
      transform: translateY(0);
      box-shadow: 0 4px 10px rgba(79, 70, 229, 0.3);
    }

    button span.icon {
      font-size: 0.9rem;
    }

    #count-label {
      font-size: 0.75rem;
      color: #9ca3af;
    }

    #scene-container {
      flex: 1;
      position: relative;
    }

    #scene-container canvas {
      display: block;
    }

    #hint {
      position: absolute;
      bottom: 0.75rem;
      left: 50%;
      transform: translateX(-50%);
      padding: 0.4rem 0.7rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.8);
      color: #9ca3af;
      font-size: 0.7rem;
      border: 1px solid rgba(148, 163, 184, 0.3);
      pointer-events: none;
      white-space: nowrap;
    }
  </style>
</head>
<body>
  <div id="app">
    <header>
      <div>
        <h1>3D Cube Generator</h1>
        <span>Random cubes in 3D space ¬∑ Three.js</span>
      </div>
      <div id="controls">
        <span id="count-label"></span>
        <button id="regenerate-btn">
          <span class="icon">üîÅ</span>
          <span>Regenerate</span>
        </button>
      </div>
    </header>
    <div id="scene-container">
      <div id="hint">Drag to orbit ¬∑ Scroll to zoom ¬∑ Right-click to pan</div>
    </div>
  </div>

  <!-- Three.js & OrbitControls via CDN -->
  <script src="https://unpkg.com/three@0.165.0/build/three.min.js"></script>
  <script src="https://unpkg.com/three@0.165.0/examples/js/controls/OrbitControls.js"></script>

  <script>
    const container = document.getElementById("scene-container");

    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x020617);

    const camera = new THREE.PerspectiveCamera(
      60,
      window.innerWidth / window.innerHeight,
      0.1,
      1000
    );
    camera.position.set(10, 10, 14);

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.shadowMap.enabled = true;
    container.appendChild(renderer.domElement);

    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.05;

    const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
    scene.add(ambientLight);

    const dirLight = new THREE.DirectionalLight(0xffffff, 1.1);
    dirLight.position.set(5, 10, 7);
    dirLight.castShadow = true;
    dirLight.shadow.mapSize.set(2048, 2048);
    scene.add(dirLight);

    const groundGeo = new THREE.PlaneGeometry(60, 60);
    const groundMat = new THREE.MeshStandardMaterial({
      color: 0x020617,
      roughness: 0.9,
      metalness: 0.1,
    });
    const ground = new THREE.Mesh(groundGeo, groundMat);
    ground.rotation.x = -Math.PI / 2;
    ground.position.y = -6;
    ground.receiveShadow = true;
    scene.add(ground);

    const cubeGroup = new THREE.Group();
    scene.add(cubeGroup);

    function randomColor() {
      const palette = [
        0x38bdf8,
        0xa855f7,
        0xf97316,
        0x22c55e,
        0xfacc15,
        0xec4899,
      ];
      return palette[Math.floor(Math.random() * palette.length)];
    }

    function generateRandomCubes(count = 80) {
      while (cubeGroup.children.length > 0) {
        const obj = cubeGroup.children[0];
        cubeGroup.remove(obj);
        obj.geometry.dispose();
        obj.material.dispose();
      }

      const sizeMin = 0.3;
      const sizeMax = 1.6;
      const spread = 10;

      for (let i = 0; i < count; i++) {
        const size =
          sizeMin + Math.random() * (sizeMax - sizeMin);

        const geometry = new THREE.BoxGeometry(size, size, size);
        const material = new THREE.MeshStandardMaterial({
          color: randomColor(),
          roughness: 0.4,
          metalness: 0.6,
        });

        const cube = new THREE.Mesh(geometry, material);
        cube.castShadow = true;
        cube.receiveShadow = true;

        cube.position.set(
          (Math.random() - 0.5) * spread * 2,
          (Math.random() - 0.5) * spread,
          (Math.random() - 0.5) * spread * 2
        );

        cube.rotation.set(
          Math.random() * Math.PI,
          Math.random() * Math.PI,
          Math.random() * Math.PI
        );

        cubeGroup.add(cube);
      }

      document.getElementById("count-label").textContent =
        count + " cubes";
    }

    let cubeCount = 80;
    generateRandomCubes(cubeCount);

    const regenerateBtn = document.getElementById("regenerate-btn");
    regenerateBtn.addEventListener("click", () => {
      const jitter = Math.floor(Math.random() * 21) - 10;
      cubeCount = Math.max(20, cubeCount + jitter);
      generateRandomCubes(cubeCount);
    });

    window.addEventListener("resize", () => {
      const width = window.innerWidth;
      const height = window.innerHeight;
      camera.aspect = width / height;
      camera.updateProjectionMatrix();
      renderer.setSize(width, height);
    });

    function animate() {
      requestAnimationFrame(animate);

      cubeGroup.rotation.y += 0.0015;
      cubeGroup.rotation.x += 0.0006;

      controls.update();
      renderer.render(scene, camera);
    }

    animate();
  </script>
</body>
</html>
